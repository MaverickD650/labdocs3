---
title: Overview
description: Overview of my infrastructure
---
The cluster is currently a singe node setup running Talos Linux. The node is an MS01 with 64GB of RAM, a 1TB nvme system disk and 2TB nvme Longhorn disk. TrueNAS SCALE provides mass storage via NFS to the cluster.

The cluster is managed via Clustertool which currently manages my configuration for Talos and FluxCD. FluxCD is used to manage my applications and services via GitOps. I have made some customisations to Clustertool to better suit my needs making sure it's up to date and compatible with the latest versions of Talos and FluxCD.

Storage is provided via Longhorn running on a dedicated disk as a Talos user volume. This storage is consumed by applications and services running in the cluster. Volsync is used to back up Longohorn volumes to the cloud daily via restic. This solution also restores data as needed e.g. for disaster recovery. Mass storage is provided via TrueNAS SCALE via NFS. This is used for large media files and other data that does not require the performance of Longhorn.

Databases are provided via CloudNativePG which provides highly available Postgres databases. This is used for applications and services that require a database. It also provides a backup solution for the databases which are stored in the cloud.

Networking is provided by Cilium at it's core. Cilium currently provides only basic networking for pods and services in the cluster. I do not currently use the Gateway API, ip address management or network policies. These are areas I want to explore in the future. IP address management is currently provided by MetalLB which provides a simple solution for load balancing and IP address management. Cloudflare tunnels and Tailscale are used to provide secure access to the cluster for remote access beyond the local network. This is a risk based decision to avoid exposing the cluster to the internet directly as much as possible while still providing access when needed.

For internal DNS I use a combination of Blocky and K8S gateway provided in cluster in combination with PiHole updated by ExternalDNS as a fallback. This provides a robust solution for DNS resolution in the cluster and on the local network. Ingress is provided by Traefik and I primarilily utilise standard ingress rather than the Gateway API and ingress routes. This maximises compatibility with applications and services while still providing a robust solution for ingress. I have also not yet found a good replacment for forward auth and other Traefik middleware features in Gateway API and TLS is more painful to implement. I do want to explore the Gateway API more in the future as it does provide a more robust solution for ingress and I want to be able to use it when needed.

Authentication is provided by Authelia using LLDAP as the backend. This provides a robust solution for authentication and authorisation for applications and services in the cluster. Combined with forward auth in Traefik this provides a secure solution for access to applications and services. I have also found this solution to be more lightweight than something akin to Authentik which I don't think is necessary for my use case.

I also use Prometheus and Grafana for monitoring and alerting. This provides a robust solution for monitoring the cluster and applications and services running in the cluster. Trying to get the best out of these solutions is a work in progress as I want to be able to monitor the cluster and applications and services effectively without being overwhelmed by alerts. I also want to explore Loki for log aggregation in the future as I think this will provide a more robust solution for log management in the cluster. I have also found Prometheus to be quite resource intensive out of the box so modifications have been made to reduce the resource usage. Related to this I also use Gatus for uptime monitoring of applications and services. This is a lightweight solution that provides a simple way to monitor the availability of applications and services. I can also store the configuration in Git which is a bonus. Gatus still has storage but this purely for uptime data and not a disaster if lost for any reason.
